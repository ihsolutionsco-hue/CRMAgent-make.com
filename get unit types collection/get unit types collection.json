{
  "name": "get unit types collection",
  "flow": [
    {
      "id": 1,
      "module": "http:ActionSendData",
      "version": 3,
      "parameters": {
        "handleErrors": true,
        "useNewZLibDeCompress": true
      },
      "mapper": {
        "url": "https://ihmvacations.trackhs.com/api/pms/units/types",
        "serializeUrl": false,
        "method": "get",
        "headers": [
          { "name": "Accept", "value": "application/json" }
        ],
        "qs": [
          { "name": "page", "value": "{{ifempty(var.input.page; 1)}}" },
          { "name": "size", "value": "{{ifempty(var.input.size; null)}}" },
          { "name": "sortColumn", "value": "{{ifempty(var.input.sortColumn; \"name\")}}" },
          { "name": "sortDirection", "value": "{{ifempty(var.input.sortDirection; \"asc\")}}" },
          { "name": "nodeId", "value": "{{ifempty(var.input.nodeId; null)}}" },
          { "name": "updatedSince", "value": "{{ifempty(var.input.updatedSince; null)}}" },
          { "name": "search", "value": "{{ifempty(var.input.search; null)}}" },
          { "name": "term", "value": "{{ifempty(var.input.term; null)}}" },
          { "name": "calendarId", "value": "{{ifempty(var.input.calendarId; null)}}" },
          { "name": "allowUnitRates", "value": "{{ifempty(var.input.allowUnitRates; null)}}" },
          { "name": "isActive", "value": "{{ifempty(var.input.isActive; null)}}" }
        ],
        "bodyType": "",
        "parseResponse": true,
        "authUser": "{{var.auth.user}}",
        "authPass": "{{var.auth.pass}}",
        "timeout": "",
        "shareCookies": false,
        "ca": "",
        "rejectUnauthorized": true,
        "followRedirect": true,
        "useQuerystring": false,
        "gzip": true,
        "useMtls": false,
        "followAllRedirects": false
      },
      "metadata": {
        "designer": { "x": 0, "y": 0, "name": "api:getUnitTypes" },
        "restore": {
          "expect": {
            "method": { "mode": "chose", "label": "GET" },
            "headers": { "mode": "chose", "items": [ null ] },
            "qs": { "mode": "chose", "items": [ null ] },
            "bodyType": { "label": "Empty" }
          }
        },
        "parameters": [
          { "name": "handleErrors", "type": "boolean", "label": "Evaluate all states as errors (except for 2xx and 3xx )", "required": true },
          { "name": "useNewZLibDeCompress", "type": "hidden" }
        ],
        "expect": [
          { "name": "url", "type": "url", "label": "URL", "required": true },
          { "name": "serializeUrl", "type": "boolean", "label": "Serialize URL", "required": true },
          {
            "name": "method",
            "type": "select",
            "label": "Method",
            "required": true,
            "validate": { "enum": [ "get", "head", "post", "put", "patch", "delete", "options" ] }
          },
          {
            "name": "headers",
            "type": "array",
            "label": "Headers",
            "spec": [
              { "name": "name", "label": "Name", "type": "text", "required": true },
              { "name": "value", "label": "Value", "type": "text" }
            ]
          },
          {
            "name": "qs",
            "type": "array",
            "label": "Query String",
            "spec": [
              { "name": "name", "label": "Name", "type": "text", "required": true },
              { "name": "value", "label": "Value", "type": "text" }
            ]
          },
          { "name": "bodyType", "type": "select", "label": "Body type", "validate": { "enum": [ "raw", "x_www_form_urlencoded", "multipart_form_data" ] } },
          { "name": "parseResponse", "type": "boolean", "label": "Parse response", "required": true },
          { "name": "authUser", "type": "text", "label": "User name" },
          { "name": "authPass", "type": "password", "label": "Password" },
          { "name": "timeout", "type": "uinteger", "label": "Timeout", "validate": { "max": 300, "min": 1 } },
          { "name": "shareCookies", "type": "boolean", "label": "Share cookies with other HTTP modules", "required": true },
          { "name": "ca", "type": "cert", "label": "Self-signed certificate" },
          { "name": "rejectUnauthorized", "type": "boolean", "label": "Reject connections that are using unverified (self-signed) certificates", "required": true },
          { "name": "followRedirect", "type": "boolean", "label": "Follow redirect", "required": true },
          { "name": "useQuerystring", "type": "boolean", "label": "Disable serialization of multiple same query string keys as arrays", "required": true },
          { "name": "gzip", "type": "boolean", "label": "Request compressed content", "required": true },
          { "name": "useMtls", "type": "boolean", "label": "Use Mutual TLS", "required": true },
          { "name": "followAllRedirects", "type": "boolean", "label": "Follow all redirect", "required": true }
        ],
        "advanced": true
      }
    },
    {
      "id": 2,
      "module": "scenario-service:ReturnData",
      "version": 2,
      "parameters": {},
      "mapper": {
        "unitTypes": "{{1.data.`_embedded`.units}}",
        "page": "{{1.data.page}}",
        "page_count": "{{1.data.page_count}}",
        "page_size": "{{1.data.page_size}}",
        "total_items": "{{1.data.total_items}}",
        "next_href": "{{1.data.`_links`.next.href}}",
        "prev_href": "{{1.data.`_links`.prev.href}}",
        "first_href": "{{1.data.`_links`.first.href}}",
        "last_href": "{{1.data.`_links`.last.href}}"
      },
      "metadata": {
        "designer": { "x": 300, "y": 0 },
        "restore": {},
        "expect": [
          { "name": "unitTypes", "type": "text", "label": "" },
          { "name": "page", "type": "text", "label": "" },
          { "name": "page_count", "type": "text", "label": "" },
          { "name": "page_size", "type": "text", "label": "" },
          { "name": "total_items", "type": "text", "label": "" },
          { "name": "next_href", "type": "text", "label": "" },
          { "name": "prev_href", "type": "text", "label": "" },
          { "name": "first_href", "type": "text", "label": "" },
          { "name": "last_href", "type": "text", "label": "" }
        ]
      }
    }
  ],
  "metadata": {
    "instant": false,
    "version": 1,
    "scenario": {
      "roundtrips": 1,
      "maxErrors": 3,
      "autoCommit": true,
      "autoCommitTriggerLast": true,
      "sequential": false,
      "slots": null,
      "confidential": false,
      "dataloss": false,
      "dlq": false,
      "freshVariables": false
    },
    "designer": { "orphans": [] },
    "zone": "us2.make.com",
    "notes": [
      "=== CONFIGURACIÓN DE AUTENTICACIÓN ===",
      "IMPORTANTE: Configurar autenticación Basic Auth en el módulo HTTP",
      "El módulo HTTP debe tener configurado:",
      "  - Username: Tu usuario de TrackHS (ej: aba99777416466b6bdc1a25223192ccb)",
      "  - Password: Tu contraseña de TrackHS",
      "Si recibes error 403 Forbidden, verifica que las credenciales estén correctamente configuradas",
      "",
      "=== LÍMITES DE TAMAÑO ===",
      "Make.com tiene límite de 200,000 tokens por respuesta",
      "  - Usar size=1-5 para evitar exceder el límite (default: null = sin límite)",
      "  - Tamaños grandes (10+) pueden causar error 400: \"This model's maximum context length is 200000 tokens\"",
      "  - Para grandes volúmenes, usar paginación (múltiples llamadas con page incrementando)",
      "",
      "=== FILTROS BOOLEANOS ===",
      "Los valores booleanos en la API de unit types aceptan 1 o 0 (no true/false):",
      "  - allowUnitRates: 1 (sí) o 0 (no)",
      "  - isActive: 1 (activo), 0 (inactivo), o null (todos)",
      "",
      "=== PAGINACIÓN ===",
      "page:",
      "  - Número de página (1-based, mínimo 1)",
      "  - Default: 1 (primera página)",
      "  - Limitado a 10k total results (page * size)",
      "  - NOTA: La API no acepta page=0, debe ser >= 1",
      "",
      "size:",
      "  - Tamaño de página (número de unit types por página)",
      "  - Default: null (sin límite, pero recomendado usar valores pequeños para evitar exceder límites de tokens)",
      "",
      "=== ORDENAMIENTO ===",
      "sortColumn valores permitidos: id, name, nodeName, shortDescription, longDescription, createdAt",
      "sortDirection: asc (ascendente) o desc (descendente)",
      "Default: sortColumn=name, sortDirection=asc",
      "",
      "=== FILTROS DE BÚSQUEDA ===",
      "search:",
      "  - Búsqueda por subcadena en nombre o descripciones",
      "  - Coincidencia parcial en múltiples campos",
      "",
      "term:",
      "  - Búsqueda por subcadena en término",
      "  - Coincidencia parcial",
      "",
      "=== FILTROS DE NODO ===",
      "nodeId:",
      "  - Puede ser un integer (single node) o CSV para múltiples valores (ej: \"1,2,3\")",
      "  - Devuelve todos los unit types que son descendientes del nodo específico",
      "  - Para múltiples nodos, usar formato CSV (ej: \"1,2,3\")",
      "",
      "=== FILTROS DE FECHA ===",
      "updatedSince:",
      "  - DEPRECADO: Este parámetro está marcado como deprecated en la API",
      "  - Usa formato date (ISO 8601)",
      "  - Ejemplo: updatedSince=2025-01-01",
      "  - Devuelve unit types actualizados desde esta fecha",
      "",
      "=== OTROS FILTROS ===",
      "calendarId:",
      "  - Integer",
      "  - Devuelve todos los unit types que coinciden con este calendar group id",
      "",
      "allowUnitRates:",
      "  - 1 (sí) o 0 (no)",
      "  - Devuelve unit types que permiten tarifas de unidad",
      "",
      "isActive:",
      "  - 1 (activo), 0 (inactivo), o null (todos)",
      "  - Devuelve unit types activos, inactivos, o todos según el valor"
    ]
  },
  "io": {
    "input_spec": [
      { "name": "page", "label": "Número de Página", "help": "Página (1-based, mínimo 1). Default: 1. Limitado a 10k total results (page * size)", "type": "number", "default": 1, "required": false },
      { "name": "size", "label": "Tamaño de Página", "help": "Tamaño de página (número de unit types por página). Default: null (sin límite). Recomendado: 1-5 para evitar exceder límite de tokens. Máximo API: limitado por 10k total results", "type": "number", "default": null, "required": false },
      { "name": "sortColumn", "label": "Columna de Ordenamiento", "help": "Ordenar por columna. Valores: id, name, nodeName, shortDescription, longDescription, createdAt. Default: name", "type": "text", "default": "name", "required": false, "multiline": false },
      { "name": "sortDirection", "label": "Dirección de Ordenamiento", "help": "Dirección de ordenamiento. asc | desc. Default: asc", "type": "text", "default": "asc", "required": false, "multiline": false },
      { "name": "nodeId", "label": "Node ID(s)", "help": "nodeId(s). CSV para múltiples valores o un integer. Devuelve unit types descendientes del nodo específico", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "updatedSince", "label": "Actualizado Desde", "help": "DEPRECADO: Fecha en formato ISO 8601 (date). Devuelve unit types actualizados desde esta fecha", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "search", "label": "Búsqueda", "help": "Búsqueda por subcadena en nombre o descripciones", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "term", "label": "Término de Búsqueda", "help": "Búsqueda por subcadena en término", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "calendarId", "label": "Calendar ID", "help": "Devuelve unit types que coinciden con este calendar group id", "type": "number", "default": null, "required": false },
      { "name": "allowUnitRates", "label": "Permite Tarifas de Unidad", "help": "Devuelve unit types que permiten tarifas de unidad. Valores: 1 (sí) o 0 (no)", "type": "number", "default": null, "required": false },
      { "name": "isActive", "label": "Activo", "help": "Devuelve unit types activos (1), inactivos (0), o todos (null)", "type": "number", "default": null, "required": false }
    ],
    "output_spec": [
      { "name": "unitTypes", "label": "Unit Types", "help": "Array de unit types con información completa. Cada unit type incluye:\n\n- Información básica: id, name, nodeId, shortDescription, longDescription\n- Tipo de alojamiento: lodgingTypeId\n- Políticas de mascotas: petFriendly (string), petsFriendly (boolean), maxPets\n- Direcciones e instrucciones: directions, checkinDetails\n- Configuración de tiempo: timezone, checkinTime, hasEarlyCheckin, earlyCheckinTime, checkoutTime, hasLateCheckout, lateCheckoutTime\n- Información web: websiteUrl\n- Capacidad: maxOccupancy\n- Contacto: phone\n- Dirección completa: streetAddress, extendedAddress, locality, region, postal, country\n- Coordenadas: longitude, latitude\n- Políticas: eventsAllowed, smokingAllowed, childrenAllowed, minimumAgeLimit, isAccessible\n- Características físicas: area, floors, securityDeposit, bedrooms, fullBathrooms, threeQuarterBathroom, halfBathrooms\n- Reglas: houseRules\n- Configuración: bedTypes (array), rooms (array)\n- Amenities: amenities (array con amenity objects), amenityDescription\n- Campos personalizados: custom (objeto)\n- Información de actualización: updated (objeto con availability, content, pricing)\n- Otros: localOfficeId, taxId, updatedAt\n- Enlaces: _links (self)", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "page", "label": "Página Actual", "help": "Página actual de resultados", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "page_count", "label": "Total de Páginas", "help": "Cantidad total de páginas disponibles", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "page_size", "label": "Tamaño de Página", "help": "Tamaño de página (número de unit types por página)", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "total_items", "label": "Total de Items", "help": "Total de unit types encontrados", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "next_href", "label": "Siguiente Enlace", "help": "Enlace para obtener la siguiente página (si existe)", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "prev_href", "label": "Enlace Anterior", "help": "Enlace para obtener la página anterior (si existe)", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "first_href", "label": "Primera Página", "help": "Enlace para obtener la primera página", "type": "text", "default": "", "required": false, "multiline": false },
      { "name": "last_href", "label": "Última Página", "help": "Enlace para obtener la última página", "type": "text", "default": "", "required": false, "multiline": false }
    ]
  }
}

