{
    "name": "get_reservation_by_id",
    "flow": [
        {
            "id": 10,
            "module": "http:ActionSendData",
            "version": 3,
            "parameters": {
                "handleErrors": true,
                "useNewZLibDeCompress": true
            },
            "mapper": {
                "url": "https://ihmvacations.trackhs.com/api/v2/pms/reservations/{{var.input.reservationId}}",
                "serializeUrl": false,
                "method": "get",
                "headers": [
                    {
                        "name": "Accept",
                        "value": "application/json"
                    }
                ],
                "qs": [],
                "bodyType": "",
                "parseResponse": true,
                "authUser": "{{var.organization.user}}",
                "authPass": "{{var.organization.password}}",
                "timeout": "",
                "shareCookies": false,
                "ca": "",
                "rejectUnauthorized": true,
                "followRedirect": true,
                "useQuerystring": false,
                "gzip": true,
                "useMtls": false,
                "followAllRedirects": false
            },
            "metadata": {
                "designer": {
                    "x": 0,
                    "y": 0,
                    "name": "api:getReservationById"
                },
                "restore": {
                    "expect": {
                        "method": {
                            "mode": "chose",
                            "label": "GET"
                        },
                        "headers": {
                            "mode": "chose",
                            "items": [
                                null
                            ]
                        },
                        "qs": {
                            "mode": "chose",
                            "items": [
                                null
                            ]
                        },
                        "bodyType": {
                            "label": "Empty"
                        }
                    }
                },
                "parameters": [
                    {
                        "name": "handleErrors",
                        "type": "boolean",
                        "label": "Evaluate all states as errors (except for 2xx and 3xx )",
                        "required": true
                    },
                    {
                        "name": "useNewZLibDeCompress",
                        "type": "hidden"
                    }
                ],
                "expect": [
                    {
                        "name": "url",
                        "type": "url",
                        "label": "URL",
                        "required": true
                    },
                    {
                        "name": "serializeUrl",
                        "type": "boolean",
                        "label": "Serialize URL",
                        "required": true
                    },
                    {
                        "name": "method",
                        "type": "select",
                        "label": "Method",
                        "required": true,
                        "validate": {
                            "enum": [
                                "get",
                                "head",
                                "post",
                                "put",
                                "patch",
                                "delete",
                                "options"
                            ]
                        }
                    },
                    {
                        "name": "headers",
                        "type": "array",
                        "label": "Headers",
                        "spec": [
                            {
                                "name": "name",
                                "label": "Name",
                                "type": "text",
                                "required": true
                            },
                            {
                                "name": "value",
                                "label": "Value",
                                "type": "text"
                            }
                        ]
                    },
                    {
                        "name": "qs",
                        "type": "array",
                        "label": "Query String",
                        "spec": [
                            {
                                "name": "name",
                                "label": "Name",
                                "type": "text",
                                "required": true
                            },
                            {
                                "name": "value",
                                "label": "Value",
                                "type": "text"
                            }
                        ]
                    },
                    {
                        "name": "bodyType",
                        "type": "select",
                        "label": "Body type",
                        "validate": {
                            "enum": [
                                "raw",
                                "x_www_form_urlencoded",
                                "multipart_form_data"
                            ]
                        }
                    },
                    {
                        "name": "parseResponse",
                        "type": "boolean",
                        "label": "Parse response",
                        "required": true
                    },
                    {
                        "name": "authUser",
                        "type": "text",
                        "label": "User name"
                    },
                    {
                        "name": "authPass",
                        "type": "password",
                        "label": "Password"
                    },
                    {
                        "name": "timeout",
                        "type": "uinteger",
                        "label": "Timeout",
                        "validate": {
                            "max": 300,
                            "min": 1
                        }
                    },
                    {
                        "name": "shareCookies",
                        "type": "boolean",
                        "label": "Share cookies with other HTTP modules",
                        "required": true
                    },
                    {
                        "name": "ca",
                        "type": "cert",
                        "label": "Self-signed certificate"
                    },
                    {
                        "name": "rejectUnauthorized",
                        "type": "boolean",
                        "label": "Reject connections that are using unverified (self-signed) certificates",
                        "required": true
                    },
                    {
                        "name": "followRedirect",
                        "type": "boolean",
                        "label": "Follow redirect",
                        "required": true
                    },
                    {
                        "name": "useQuerystring",
                        "type": "boolean",
                        "label": "Disable serialization of multiple same query string keys as arrays",
                        "required": true
                    },
                    {
                        "name": "gzip",
                        "type": "boolean",
                        "label": "Request compressed content",
                        "required": true
                    },
                    {
                        "name": "useMtls",
                        "type": "boolean",
                        "label": "Use Mutual TLS",
                        "required": true
                    },
                    {
                        "name": "followAllRedirects",
                        "type": "boolean",
                        "label": "Follow all redirect",
                        "required": true
                    }
                ],
                "advanced": true
            }
        },
        {
            "id": 7,
            "module": "scenario-service:ReturnData",
            "version": 2,
            "parameters": {},
            "mapper": {
                "return_data": "{{10.data}}"
            },
            "metadata": {
                "designer": {
                    "x": 300,
                    "y": 0
                },
                "restore": {},
                "expect": [
                    {
                        "name": "return_data",
                        "type": "any",
                        "label": ""
                    }
                ]
            }
        }
    ],
    "metadata": {
        "instant": false,
        "version": 1,
        "scenario": {
            "roundtrips": 1,
            "maxErrors": 3,
            "autoCommit": true,
            "autoCommitTriggerLast": true,
            "sequential": false,
            "slots": null,
            "confidential": false,
            "dataloss": false,
            "dlq": false,
            "freshVariables": false
        },
        "designer": {
            "orphans": []
        },
        "zone": "us2.make.com",
        "notes": [
            "=== CONFIGURACIÓN DE AUTENTICACIÓN ===",
            "IMPORTANTE: Configurar autenticación Basic Auth en el módulo HTTP",
            "El módulo HTTP debe tener configurado:",
            "  - Username: Tu usuario de TrackHS (ej: aba99777416466b6bdc1a25223192ccb)",
            "  - Password: Tu contraseña de TrackHS",
            "Si recibes error 403 Forbidden, verifica que las credenciales estén correctamente configuradas",
            "",
            "=== ENDPOINT ===",
            "GET /api/v2/pms/reservations/{reservationId}",
            "Obtiene la información completa de una reserva específica por su ID.",
            "",
            "=== RESPUESTA ===",
            "Esta herramienta devuelve la información completa de una reserva, incluyendo:",
            "  - Información básica: id, altConf (confirmation alternativo), currency",
            "  - Unidad: unitId, isUnitLocked, isUnitAssigned, isUnitTypeLocked, unitTypeId",
            "  - Fechas: arrivalDate, departureDate, arrivalTime, departureTime, nights",
            "  - Estado: status (Hold, Confirmed, Checked Out, Checked In, Cancelled), cancelledAt",
            "  - Ocupantes: occupants (objeto con adults, children, pets, etc.)",
            "  - Depósitos: requiredSecurityDeposit, remainingSecurityDeposit",
            "  - Precios: quoteBreakdown (desglose de cotización con rates, fees, taxes, total)",
            "  - Folio: folioBreakdown (desglose de folio con cargos y pagos)",
            "  - Contacto: contactId, contact (objeto con información del huésped)",
            "  - Pagos: payments (array con información de pagos realizados)",
            "  - Notas: notes (array con notas de la reserva)",
            "  - Políticas: policies (objeto con políticas aplicadas)",
            "  - Metadatos: createdAt, createdBy, updatedAt, updatedBy",
            "  - Enlaces: _links (self, contact, unit, etc.)",
            "",
            "=== ERRORES COMUNES ===",
            "  - 401 Unauthorized: Credenciales inválidas o faltantes",
            "  - 403 Forbidden: Sin permisos para acceder al recurso",
            "  - 404 Not Found: La reserva con el ID especificado no existe",
            "  - 500 Internal Server Error: Error interno del servidor",
            "",
            "=== USO CON AGENTES IA ===",
            "⚠️ IMPORTANTE: Si usas esta herramienta con un agente de IA y recibes el error:",
            "\"Array must contain at least 1 element(s)\" en \"config.outputParserFormat.schema\"",
            "Configura el campo outputParserFormat.schema en el módulo AI Agent con al menos un campo.",
            "Ver SOLUCION_ERROR_AGENTE.md para más detalles."
        ]
    },
    "io": {
        "input_spec": [
            {
                "help": "[REQUERIDO] ID de la reserva a consultar. Según la especificación OpenAPI, el reservationId es de tipo string en el path parameter, aunque contenga valores numéricos. Make.com acepta números enteros que se convertirán automáticamente a string en la URL.",
                "name": "reservationId",
                "type": "text",
                "label": "Reservation ID",
                "default": null,
                "required": true
            }
        ],
        "output_spec": [
            {
                "help": "Objeto completo con toda la información de la reserva obtenida de la API TrackHS, incluyendo:\n\n- Información básica: id, altConf (confirmation alternativo), currency\n- Unidad: unitId, isUnitLocked, isUnitAssigned, isUnitTypeLocked, unitTypeId\n- Fechas: arrivalDate (YYYY-MM-DD), departureDate (YYYY-MM-DD), arrivalTime (ISO 8601), departureTime (ISO 8601), nights\n- Estado: status (Hold, Confirmed, Checked Out, Checked In, Cancelled), cancelledAt\n- Ocupantes: occupants (objeto con adults, children, pets, etc.)\n- Depósitos: requiredSecurityDeposit, remainingSecurityDeposit\n- Precios: quoteBreakdown (desglose de cotización con rates, fees, taxes, total, balance)\n- Folio: folioBreakdown (desglose de folio con cargos y pagos)\n- Contacto: contactId, contact (objeto con información del huésped)\n- Pagos: payments (array con información de pagos realizados)\n- Notas: notes (array con notas de la reserva)\n- Políticas: policies (objeto con políticas aplicadas)\n- Metadatos: createdAt, createdBy, updatedAt, updatedBy\n- Enlaces: _links (self, contact, unit, etc.)\n\n⚠️ NOTA: Algunos campos pueden ser null dependiendo del estado y configuración de la reserva.",
                "name": "return_data",
                "type": "any",
                "label": "Reserva",
                "default": "",
                "required": false
            }
        ]
    }
}